import{S as O,i as Y,s as q,v as Ke,k as m,a as V,q as w,w as W,l as v,m as g,h as d,c as x,r as b,x as Z,n as M,p as I,b as D,G as p,y as X,I as ks,J as He,u as z,g as B,t as S,z as A,d as K,f as k,K as $s,L as Je,H as L,C as Lt,D as Zt,E as Gt,F as Qt,M as Ut,N as Ds,B as T,e as R,O as tt,P as st,Q as Is,R as Ss,T as Vs}from"../../../chunks/index-2067998d.js";import{w as Re}from"../../../chunks/index-e9e079ee.js";function xs(){const{subscribe:r,update:e}=Re([]);return{subscribe:r,openWindow:t=>e(s=>(s.push(t),s)),closeWindow:t=>e(s=>(s.splice(s.indexOf(t),1),s))}}const Ft=xs();function Ps(r){let e,t,s,l,i,n,o=r[0].title+"",a,c,h,f,u,_,y,$,N,H,P,G;var Q=r[0].component;function J(C){return{}}return Q&&($=Ke(Q,J())),{c(){e=m("div"),t=m("div"),s=m("div"),l=m("div"),i=V(),n=m("span"),a=w(o),c=V(),h=m("div"),f=m("button"),u=w("X"),_=V(),y=m("div"),$&&W($.$$.fragment),this.h()},l(C){e=v(C,"DIV",{class:!0});var U=g(e);t=v(U,"DIV",{class:!0});var ee=g(t);s=v(ee,"DIV",{class:!0});var te=g(s);l=v(te,"DIV",{class:!0}),g(l).forEach(d),i=x(te),n=v(te,"SPAN",{class:!0});var ne=g(n);a=b(ne,o),ne.forEach(d),te.forEach(d),c=x(ee),h=v(ee,"DIV",{class:!0});var le=g(h);f=v(le,"BUTTON",{class:!0});var ie=g(f);u=b(ie,"X"),ie.forEach(d),le.forEach(d),ee.forEach(d),_=x(U),y=v(U,"DIV",{class:!0});var re=g(y);$&&Z($.$$.fragment,re),re.forEach(d),U.forEach(d),this.h()},h(){M(l,"class","icon svelte-14g2kbm"),M(n,"class","title svelte-14g2kbm"),M(s,"class","left svelte-14g2kbm"),M(f,"class","close svelte-14g2kbm"),M(h,"class","right svelte-14g2kbm"),M(t,"class","window-bar svelte-14g2kbm"),M(y,"class","content svelte-14g2kbm"),M(e,"class",N="window "+(r[3]?"window-closing":"")+" svelte-14g2kbm"),I(e,"top",`${r[2]}px`),I(e,"left",`${r[1]}px`)},m(C,U){D(C,e,U),p(e,t),p(t,s),p(s,l),p(s,i),p(s,n),p(n,a),p(t,c),p(t,h),p(h,f),p(f,u),p(e,_),p(e,y),$&&X($,y,null),H=!0,P||(G=[ks(r[4].call(null,s)),He(f,"click",r[5])],P=!0)},p(C,[U]){if((!H||U&1)&&o!==(o=C[0].title+"")&&z(a,o),Q!==(Q=C[0].component)){if($){B();const ee=$;S(ee.$$.fragment,1,0,()=>{A(ee,1)}),K()}Q?($=Ke(Q,J()),W($.$$.fragment),k($.$$.fragment,1),X($,y,null)):$=null}(!H||U&8&&N!==(N="window "+(C[3]?"window-closing":"")+" svelte-14g2kbm"))&&M(e,"class",N),U&4&&I(e,"top",`${C[2]}px`),U&2&&I(e,"left",`${C[1]}px`)},i(C){H||($&&k($.$$.fragment,C),H=!0)},o(C){$&&S($.$$.fragment,C),H=!1},d(C){C&&d(e),$&&A($),P=!1,$s(G)}}}function Ts(r,e,t){let{windowData:s}=e,l=15,i=15,n=!1;function o(c){let h=!1;c.style.cursor="move",c.style.userSelect="none";const f=()=>{h=!0},u=y=>{h&&(t(1,l+=y.movementX),t(2,i+=y.movementY),l<0&&t(1,l=0),i<0&&t(2,i=0),l>window.innerWidth-120&&t(1,l=window.innerWidth-120),i>window.innerHeight-120&&t(2,i=window.innerHeight-120))},_=()=>{h=!1};return c.addEventListener("mousedown",f),window.addEventListener("mousemove",u),window.addEventListener("mouseup",_),{destroy(){c.removeEventListener("click",f),window.removeEventListener("click",u),window.removeEventListener("click",_)}}}function a(){t(3,n=!0),setTimeout(()=>{Ft.closeWindow(s)},700)}return r.$$set=c=>{"windowData"in c&&t(0,s=c.windowData)},[s,l,i,n,o,a]}class Ns extends O{constructor(e){super(),Y(this,e,Ts,Ps,q,{windowData:0})}}function Bt(r,e,t){const s=r.slice();return s[1]=e[t],s}function Kt(r){let e,t;return e=new Ns({props:{windowData:r[1]}}),{c(){W(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,l){X(e,s,l),t=!0},p(s,l){const i={};l&1&&(i.windowData=s[1]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function zs(r){let e,t,s=r[0],l=[];for(let n=0;n<s.length;n+=1)l[n]=Kt(Bt(r,s,n));const i=n=>S(l[n],1,1,()=>{l[n]=null});return{c(){e=m("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var o=g(e);for(let a=0;a<l.length;a+=1)l[a].l(o);o.forEach(d),this.h()},h(){M(e,"class","windows svelte-uligsk")},m(n,o){D(n,e,o);for(let a=0;a<l.length;a+=1)l[a].m(e,null);t=!0},p(n,[o]){if(o&1){s=n[0];let a;for(a=0;a<s.length;a+=1){const c=Bt(n,s,a);l[a]?(l[a].p(c,o),k(l[a],1)):(l[a]=Kt(c),l[a].c(),k(l[a],1),l[a].m(e,null))}for(B(),a=s.length;a<l.length;a+=1)i(a);K()}},i(n){if(!t){for(let o=0;o<s.length;o+=1)k(l[o]);t=!0}},o(n){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)S(l[o]);t=!1},d(n){n&&d(e),Je(l,n)}}}function Hs(r,e,t){let s;return L(r,Ft,l=>t(0,s=l)),[s]}class Rs extends O{constructor(e){super(),Y(this,e,Hs,zs,q,{})}}const Cs=r=>({}),Jt=r=>({}),js=r=>({}),es=r=>({}),Ws=r=>({}),ts=r=>({});function Xs(r){let e,t,s,l,i,n,o,a,c,h,f;const u=r[1].icon,_=Lt(u,r,r[0],ts),y=r[1].title,$=Lt(y,r,r[0],es),N=r[1].content,H=Lt(N,r,r[0],Jt);return{c(){e=m("div"),t=m("div"),s=m("div"),l=V(),i=m("div"),_&&_.c(),n=V(),$&&$.c(),o=V(),a=m("div"),c=V(),h=m("div"),H&&H.c(),this.h()},l(P){e=v(P,"DIV",{class:!0});var G=g(e);t=v(G,"DIV",{class:!0});var Q=g(t);s=v(Q,"DIV",{class:!0}),g(s).forEach(d),l=x(Q),i=v(Q,"DIV",{class:!0});var J=g(i);_&&_.l(J),n=x(J),$&&$.l(J),J.forEach(d),o=x(Q),a=v(Q,"DIV",{class:!0}),g(a).forEach(d),Q.forEach(d),c=x(G),h=v(G,"DIV",{class:!0});var C=g(h);H&&H.l(C),C.forEach(d),G.forEach(d),this.h()},h(){M(s,"class","divider svelte-93rj7i"),M(i,"class","title-bar svelte-93rj7i"),M(a,"class","divider svelte-93rj7i"),M(t,"class","title-bar-container"),M(h,"class","card-content svelte-93rj7i"),M(e,"class","card svelte-93rj7i")},m(P,G){D(P,e,G),p(e,t),p(t,s),p(t,l),p(t,i),_&&_.m(i,null),p(i,n),$&&$.m(i,null),p(t,o),p(t,a),p(e,c),p(e,h),H&&H.m(h,null),f=!0},p(P,[G]){_&&_.p&&(!f||G&1)&&Zt(_,u,P,P[0],f?Qt(u,P[0],G,Ws):Gt(P[0]),ts),$&&$.p&&(!f||G&1)&&Zt($,y,P,P[0],f?Qt(y,P[0],G,js):Gt(P[0]),es),H&&H.p&&(!f||G&1)&&Zt(H,N,P,P[0],f?Qt(N,P[0],G,Cs):Gt(P[0]),Jt)},i(P){f||(k(_,P),k($,P),k(H,P),f=!0)},o(P){S(_,P),S($,P),S(H,P),f=!1},d(P){P&&d(e),_&&_.d(P),$&&$.d(P),H&&H.d(P)}}}function As(r,e,t){let{$$slots:s={},$$scope:l}=e;return r.$$set=i=>{"$$scope"in i&&t(0,l=i.$$scope)},[l,s]}class ws extends O{constructor(e){super(),Y(this,e,As,Xs,q,{})}}function ss(r,e,t){const s=r.slice();return s[3]=e[t],s}function ls(r,e,t){const s=r.slice();return s[3]=e[t],s}function is(r){let e,t,s=r[3].label+"",l,i,n,o,a;return{c(){e=m("li"),t=m("button"),l=w(s),i=V(),this.h()},l(c){e=v(c,"LI",{class:!0});var h=g(e);t=v(h,"BUTTON",{class:!0});var f=g(t);l=b(f,s),f.forEach(d),i=x(h),h.forEach(d),this.h()},h(){M(t,"class","svelte-j96ulp"),M(e,"class",n=Ut(r[0]===r[3].value?"active":"")+" svelte-j96ulp")},m(c,h){D(c,e,h),p(e,t),p(t,l),p(e,i),o||(a=He(t,"click",function(){Ds(r[2](r[3].value))&&r[2](r[3].value).apply(this,arguments)}),o=!0)},p(c,h){r=c,h&2&&s!==(s=r[3].label+"")&&z(l,s),h&3&&n!==(n=Ut(r[0]===r[3].value?"active":"")+" svelte-j96ulp")&&M(e,"class",n)},d(c){c&&d(e),o=!1,a()}}}function ns(r){let e,t,s,l,i;var n=r[3].component;function o(a){return{}}return n&&(t=Ke(n,o())),{c(){e=m("div"),t&&W(t.$$.fragment),s=V(),this.h()},l(a){e=v(a,"DIV",{class:!0});var c=g(e);t&&Z(t.$$.fragment,c),s=x(c),c.forEach(d),this.h()},h(){M(e,"class","box svelte-j96ulp"),e.hidden=l=r[0]!==r[3].value},m(a,c){D(a,e,c),t&&X(t,e,null),p(e,s),i=!0},p(a,c){if(n!==(n=a[3].component)){if(t){B();const h=t;S(h.$$.fragment,1,0,()=>{A(h,1)}),K()}n?(t=Ke(n,o()),W(t.$$.fragment),k(t.$$.fragment,1),X(t,e,s)):t=null}(!i||c&3&&l!==(l=a[0]!==a[3].value))&&(e.hidden=l)},i(a){i||(t&&k(t.$$.fragment,a),i=!0)},o(a){t&&S(t.$$.fragment,a),i=!1},d(a){a&&d(e),t&&A(t)}}}function Os(r){let e,t,s,l,i=r[1],n=[];for(let h=0;h<i.length;h+=1)n[h]=is(ls(r,i,h));let o=r[1],a=[];for(let h=0;h<o.length;h+=1)a[h]=ns(ss(r,o,h));const c=h=>S(a[h],1,1,()=>{a[h]=null});return{c(){e=m("div"),t=m("ul");for(let h=0;h<n.length;h+=1)n[h].c();s=V();for(let h=0;h<a.length;h+=1)a[h].c();this.h()},l(h){e=v(h,"DIV",{class:!0});var f=g(e);t=v(f,"UL",{class:!0});var u=g(t);for(let _=0;_<n.length;_+=1)n[_].l(u);u.forEach(d),s=x(f);for(let _=0;_<a.length;_+=1)a[_].l(f);f.forEach(d),this.h()},h(){M(t,"class","svelte-j96ulp"),M(e,"class","tabs-container svelte-j96ulp")},m(h,f){D(h,e,f),p(e,t);for(let u=0;u<n.length;u+=1)n[u].m(t,null);p(e,s);for(let u=0;u<a.length;u+=1)a[u].m(e,null);l=!0},p(h,[f]){if(f&7){i=h[1];let u;for(u=0;u<i.length;u+=1){const _=ls(h,i,u);n[u]?n[u].p(_,f):(n[u]=is(_),n[u].c(),n[u].m(t,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=i.length}if(f&3){o=h[1];let u;for(u=0;u<o.length;u+=1){const _=ss(h,o,u);a[u]?(a[u].p(_,f),k(a[u],1)):(a[u]=ns(_),a[u].c(),k(a[u],1),a[u].m(e,null))}for(B(),u=o.length;u<a.length;u+=1)c(u);K()}},i(h){if(!l){for(let f=0;f<o.length;f+=1)k(a[f]);l=!0}},o(h){a=a.filter(Boolean);for(let f=0;f<a.length;f+=1)S(a[f]);l=!1},d(h){h&&d(e),Je(n,h),Je(a,h)}}}function Ys(r,e,t){let{items:s=[]}=e,{activeTabValue:l=1}=e;const i=n=>{t(0,l=n)};return r.$$set=n=>{"items"in n&&t(1,s=n.items),"activeTabValue"in n&&t(0,l=n.activeTabValue)},[l,s,i]}class bs extends O{constructor(e){super(),Y(this,e,Ys,Os,q,{items:1,activeTabValue:0})}}const et=Re(null);class qs{constructor(){this.effectQueue=[]}addEffect(e){this.effectQueue.push(e)}progressEffects(){for(const e of this.effectQueue)e.delay-=1;this.effectQueue=this.effectQueue.filter(e=>e.delay>0)}}let Ls=class{constructor(e,t,s,l,i){this.x=e,this.y=t,this.type=s,this.data=l,this.id=Math.random(),this.delay=i||0}},Es=class{constructor(){this.diplayName="unknown",this.name="unknown",this.id=0,this.type=0,this.behavior=0,this.x=0,this.y=0,this.stats={level:1,hp:5,maxHp:5,armor:0,evasion:0,baseDmg:1,critChance:0,critDmg:0,accuracy:0,fireRate:1,poisonDmg:0,electricityDmg:0,magneticDmg:0,coldDmg:0,fireDmg:0,strength:0,agility:0,intelligence:0,fame:0,luck:0},this.status={poison:0,electricity:0,magnetic:0,cold:0,fire:0},this.cyberdeck={type:"none",address:"127.0.0.1",power:1,defense:1,software:[]}}takeDamage(e,t){const s=e.stats.baseDmg;this.stats.hp-=s;const l=new Ls(this.x,this.y,"DMG",-s);t.effectManager.addEffect(l)}ai(e){if(this.type==1&&this.behavior==1){this.stats.hp<=0&&e.map.entities.splice(e.map.entities.indexOf(this),1);let t=this.x,s=this.y;if(Math.random()<.5?t<e.player.x?t++:t--:s<e.player.y?s++:s--,e.player.x==t&&e.player.y==s){e.player.takeDamage(this,e);return}e.map.canMove(t,s)&&(this.x=t,this.y=s)}}},Zs=class{constructor(e,t,s){this.x=e,this.y=t,this.type=s,this.id=`${e}_${t}`}setType(e){this.type=e}},Gs=class{constructor(){this.terrain=[],this.entities=[],this.rooms=[],this.lastEntityId=0,this.sizeX=0,this.sizeY=0,this.stage=1,this.playerStart=[0,0],this.setup={MAX_NODE_SIZE:16,MIN_NODE_SIZE:9,MIN_ROOM_SIZE:6}}generate(e,t){var f;this.rooms=[],this.entities=[],this.stage=t;const s=4+t;this.sizeX=20+t*5,this.sizeY=20+t*2,this.terrain=[];for(let u=0;u<this.sizeY;u++){this.terrain.push([]);for(let _=0;_<this.sizeX;_++)this.terrain[u].push(0)}const l=[],i=new $e(0,0,this.sizeX,this.sizeY);l.push(i);let n=!0;for(;n;){n=!1;for(let u=0;u<l.length;u++){let _=l[u];_.left==null&&_.right==null&&(_.width>this.setup.MAX_NODE_SIZE||_.height>this.setup.MAX_NODE_SIZE||e.rand()>.25)&&_.split(e,this.setup)&&(l.push(_.left),l.push(_.right),n=!0)}}i.createRooms(e,this.setup);for(const u of l)if(u.room!=null){this.rooms.push(u.room);for(let _=u.room.y;_<u.room.y+u.room.height;_++)for(let y=u.room.x;y<u.room.x+u.room.width;y++)_==u.room.y||_==u.room.y+u.room.height-1||y==u.room.x||y==u.room.x+u.room.width-1?this.terrain[_][y]=1:this.terrain[_][y]=2}for(const u of l)if(((f=u.halls)==null?void 0:f.length)>0)for(const _ of u.halls)for(let y=_.y;y<_.y+_.height;y++)for(let $=_.x;$<_.x+_.width;$++)this.terrain[y][$]=2;for(let u=0;u<s;u++){const _=new Es;_.type=1,_.id=this.lastEntityId,this.lastEntityId++,_.behavior=1;const y=e.rand();_.name=y>.5?"punk2":"heavy1",_.displayName=y>.5?"Punk":"Heavy unit";let $=null;do $=this.rooms[e.randMinMaxInt(1,this.rooms.length-2)];while($.capacity==$.entityCount);$.entityCount++,[_.x,_.y]=this.findPositionForSpawn($,e),this.entities.push(_)}let o=this.rooms[0];this.playerStart=this.findPositionForSpawn(o,e);let a=null;do a=this.rooms[e.randMinMaxInt(1,this.rooms.length-2)];while(a.capacity==a.entityCount);const[c,h]=this.findPositionForSpawn(a,e);this.terrain[h][c]=3}findPositionForSpawn(e,t){let s,l;const i=e.x+2,n=e.y+2,o=i+e.width-6,a=n+e.height-6;do s=t.randMinMaxInt(i,o),l=t.randMinMaxInt(n,a);while(this.getEntityAt(s,l)!=null);return[s,l]}canMove(e,t){return!(e<0||e>=this.sizeX||t<0||t>=this.sizeY||this.terrain[t][e]!=2||this.getEntityAt(e,t)!=null)}getEntityAt(e,t){for(const s of this.entities)if(s.x==e&&s.y==t)return s;return null}getTerrainRectangle(e,t,s,l){const i=[];for(let n=t-l,o=0;n<t+l;n++,o++){i.push([]),i[o].id=n;for(let a=e-s;a<e+s;a++){let c=new Zs(a,n,0);a>=0&&n>=0&&n<this.sizeY&&a<this.sizeX&&c.setType(this.terrain[n][a]),i[o].push(c)}}return i}};class Qs{constructor(e,t,s,l){this.x=e,this.y=t,this.width=s,this.height=l,this.entityCount=0,this.entityCapacity=(s-3)*(l-3)}}class F{constructor(e,t,s,l){this.x=e,this.y=t,this.width=s,this.height=l}}class $e{constructor(e,t,s,l){this.x=e,this.y=t,this.width=s,this.height=l,this.room=null,this.halls=null,this.left=null,this.right=null}split(e,t){if(this.left!=null||this.right!=null)return!1;let s=e.rand()>.5?"horizontal":"vertical";this.width>this.height&&this.width/this.height>=1.25?s="vertical":this.height>this.width&&this.height/this.width>=1.25&&(s="horizontal");const l=(s=="horizontal"?this.height:this.width)-t.MIN_NODE_SIZE;if(l<=t.MIN_NODE_SIZE)return!1;const i=e.randMinMaxInt(t.MIN_NODE_SIZE,l);return s=="horizontal"?(this.left=new $e(this.x,this.y,this.width,i),this.right=new $e(this.x,this.y+i,this.width,this.height-i)):(this.left=new $e(this.x,this.y,i,this.height),this.right=new $e(this.x+i,this.y,this.width-i,this.height)),!0}createRooms(e,t){if(this.left!=null||this.right!=null)this.left!=null&&this.left.createRooms(e,t),this.right!=null&&this.right.createRooms(e,t),this.left!=null&&this.right!=null&&this.createHall(this.left.getRoom(e),this.right.getRoom(e),e);else{const s=[e.randMinMaxInt(t.MIN_ROOM_SIZE,this.width-2),e.randMinMaxInt(t.MIN_ROOM_SIZE,this.height-2)],l=[Math.round(e.randMinMax(1,this.width-s[0]-1)),Math.round(e.randMinMax(1,this.height-s[1]-1))];this.room=new Qs(this.x+l[0],this.y+l[1],s[0],s[1])}}getRoom(e){if(this.room!=null)return this.room;{let t,s;return this.left!=null&&(t=this.left.getRoom(e)),this.right!=null&&(s=this.right.getRoom(e)),t==null&&s==null?null:s==null?t:t==null?s:e.rand()>.5?t:s}}createHall(e,t,s){if(e==null||t==null)return;let l=[],i={x:s.randMinMaxInt(e.x+2,e.x+e.width-4),y:s.randMinMaxInt(e.y+2,e.y+e.height-4)},n={x:s.randMinMaxInt(t.x+2,t.x+t.width-4),y:s.randMinMaxInt(t.y+2,t.y+t.height-4)},o=n.x-i.x,a=n.y-i.y;o<0?a<0?s.rand()<.5?(l.push(new F(n.x,i.y,Math.abs(o)+1,1)),l.push(new F(n.x,n.y,1,Math.abs(a)+1))):(l.push(new F(n.x,n.y,Math.abs(o)+1,1)),l.push(new F(i.x,n.y,1,Math.abs(a)+1))):a>0?s.rand()<.5?(l.push(new F(n.x,i.y,Math.abs(o)+1,1)),l.push(new F(n.x,i.y,1,Math.abs(a)+1))):(l.push(new F(n.x,n.y,Math.abs(o)+1,1)),l.push(new F(i.x,i.y,1,Math.abs(a)+1))):l.push(new F(n.x,n.y,Math.abs(o)+1,1)):o>0?a<0?s.rand()<.5?(l.push(new F(i.x,n.y,Math.abs(o)+1,1)),l.push(new F(i.x,n.y,1,Math.abs(a)+1))):(l.push(new F(i.x,i.y,Math.abs(o)+1,1)),l.push(new F(n.x,n.y,1,Math.abs(a)+1))):a>0?s.rand()<.5?(l.push(new F(i.x,i.y,Math.abs(o)+1,1)),l.push(new F(n.x,i.y,1,Math.abs(a)+1))):(l.push(new F(i.x,n.y,Math.abs(o)+1,1)),l.push(new F(i.x,i.y,1,Math.abs(a)+1))):l.push(new F(i.x,i.y,Math.abs(o)+1,1)):a<0?l.push(new F(n.x,n.y,1,Math.abs(a)+1)):a>0&&l.push(new F(i.x,i.y,1,Math.abs(a)+1)),this.halls=l}}let Fs=class{constructor(){this.capacity=20,this.capacityMax=20,this.slots=Array(50).fill({name:""})}},Us=class extends Es{constructor(){super(),this.inventory=new Fs,this.weapon=null,this.armor=null}move(e,t){let s=this.x,l=this.y;e=="up"?l--:e=="down"?l++:e=="left"?s--:e=="right"&&s++,t.canMove(s,l)&&(this.x=s,this.y=l)}};class Bs{constructor(e){this.seed=this.xmur3(e),this.rand=this.mulberry32(this.seed())}xmur3(e){for(var t=0,s=1779033703^e.length;t<e.length;t++)s=Math.imul(s^e.charCodeAt(t),3432918353),s=s<<13|s>>>19;return function(){return s=Math.imul(s^s>>>16,2246822507),s=Math.imul(s^s>>>13,3266489909),(s^=s>>>16)>>>0}}mulberry32(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}randMinMax(e,t){return this.rand()*(t-e+1)+e}randMinMaxInt(e,t){return Math.round(this.rand()*(t-e+1)+e)}}class Ks{constructor(e){this.stage=1,this.rng=new Bs(e),this.player=new Us,this.player.stats.baseDmg=2,this.player.stats.maxHp=30,this.player.stats.hp=30,this.map=new Gs,this.effectManager=new qs,this.map.generate(this.rng,this.stage),[this.player.x,this.player.y]=this.map.playerStart}step(e,t){this.effectManager.progressEffects(),this.handlePlayerAction(e,t),this.handleEntityLogic()}handlePlayerAction(e,t){e=="move"&&this.handlePlayerMove(t)}handlePlayerMove(e){let t=this.player.x,s=this.player.y;e=="up"?s--:e=="down"?s++:e=="left"?t--:e=="right"&&t++;let l=this.map.getEntityAt(t,s);if(l!=null){this.handleEntityInteraction(l);return}if(this.map.terrain[s][t]==3){this.nextStage();return}this.map.canMove(t,s)&&(this.player.x=t,this.player.y=s)}handleEntityInteraction(e){e.type==1&&e.takeDamage(this.player,this)}handleEntityLogic(){for(const e of this.map.entities)e.ai(this)}nextStage(){this.stage++,this.map.generate(this.rng,this.stage),[this.player.x,this.player.y]=this.map.playerStart}}function Js(){const r=new Ks(Math.random().toString()),{subscribe:e,update:t}=Re(r);return{subscribe:e,playerAction:(s,l)=>t(i=>(i.step(s,l),et.update(n=>n),i))}}const se=Js();function el(r){let e,t,s,l,i,n=r[0].stats.hp+"",o,a,c=r[0].stats.maxHp+"",h;return{c(){e=m("h2"),t=w("Stats"),s=V(),l=m("p"),i=w("HP: "),o=w(n),a=w(" / "),h=w(c)},l(f){e=v(f,"H2",{});var u=g(e);t=b(u,"Stats"),u.forEach(d),s=x(f),l=v(f,"P",{});var _=g(l);i=b(_,"HP: "),o=b(_,n),a=b(_," / "),h=b(_,c),_.forEach(d)},m(f,u){D(f,e,u),p(e,t),D(f,s,u),D(f,l,u),p(l,i),p(l,o),p(l,a),p(l,h)},p(f,[u]){u&1&&n!==(n=f[0].stats.hp+"")&&z(o,n),u&1&&c!==(c=f[0].stats.maxHp+"")&&z(h,c)},i:T,o:T,d(f){f&&d(e),f&&d(s),f&&d(l)}}}function tl(r,e,t){let s,l;return L(r,se,i=>t(1,l=i)),r.$$.update=()=>{r.$$.dirty&2&&t(0,s=l.player)},[s,l]}class sl extends O{constructor(e){super(),Y(this,e,tl,el,q,{})}}function ll(r){let e,t=r[0].name+"",s;return{c(){e=m("div"),s=w(t),this.h()},l(l){e=v(l,"DIV",{class:!0});var i=g(e);s=b(i,t),i.forEach(d),this.h()},h(){M(e,"class","slot svelte-1d13h1t")},m(l,i){D(l,e,i),p(e,s)},p(l,[i]){i&1&&t!==(t=l[0].name+"")&&z(s,t)},i:T,o:T,d(l){l&&d(e)}}}function il(r,e,t){let{slot:s}=e;return r.$$set=l=>{"slot"in l&&t(0,s=l.slot)},[s]}class nl extends O{constructor(e){super(),Y(this,e,il,ll,q,{slot:0})}}function rs(r,e,t){const s=r.slice();return s[2]=e[t],s}function as(r){let e,t;return e=new nl({props:{slot:r[2]}}),{c(){W(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,l){X(e,s,l),t=!0},p(s,l){const i={};l&1&&(i.slot=s[2]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function rl(r){let e,t,s,l,i,n,o,a=r[0],c=[];for(let f=0;f<a.length;f+=1)c[f]=as(rs(r,a,f));const h=f=>S(c[f],1,1,()=>{c[f]=null});return{c(){e=m("div"),t=m("div"),s=V(),l=m("div");for(let f=0;f<c.length;f+=1)c[f].c();i=V(),n=m("div"),this.h()},l(f){e=v(f,"DIV",{class:!0});var u=g(e);t=v(u,"DIV",{class:!0});var _=g(t);_.forEach(d),s=x(u),l=v(u,"DIV",{class:!0});var y=g(l);for(let N=0;N<c.length;N+=1)c[N].l(y);y.forEach(d),u.forEach(d),i=x(f),n=v(f,"DIV",{class:!0});var $=g(n);$.forEach(d),this.h()},h(){M(t,"class","equipment svelte-w2e4z"),M(l,"class","inventory svelte-w2e4z"),M(e,"class","inventory-container svelte-w2e4z"),M(n,"class","character-red")},m(f,u){D(f,e,u),p(e,t),p(e,s),p(e,l);for(let _=0;_<c.length;_+=1)c[_].m(l,null);D(f,i,u),D(f,n,u),o=!0},p(f,[u]){if(u&1){a=f[0];let _;for(_=0;_<a.length;_+=1){const y=rs(f,a,_);c[_]?(c[_].p(y,u),k(c[_],1)):(c[_]=as(y),c[_].c(),k(c[_],1),c[_].m(l,null))}for(B(),_=a.length;_<c.length;_+=1)h(_);K()}},i(f){if(!o){for(let u=0;u<a.length;u+=1)k(c[u]);o=!0}},o(f){c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)S(c[u]);o=!1},d(f){f&&d(e),Je(c,f),f&&d(i),f&&d(n)}}}function al(r,e,t){let s,l;return L(r,se,i=>t(1,l=i)),r.$$.update=()=>{r.$$.dirty&2&&t(0,s=l.player.inventory.slots)},[s,l]}class ol extends O{constructor(e){super(),Y(this,e,al,rl,q,{})}}function cl(r){let e;return{c(){e=m("div"),this.h()},l(t){e=v(t,"DIV",{slot:!0,class:!0}),g(e).forEach(d),this.h()},h(){M(e,"slot","icon"),M(e,"class","icon svelte-1hztnux")},m(t,s){D(t,e,s)},p:T,d(t){t&&d(e)}}}function fl(r){let e,t;return{c(){e=m("div"),t=w("Character"),this.h()},l(s){e=v(s,"DIV",{slot:!0});var l=g(e);t=b(l,"Character"),l.forEach(d),this.h()},h(){M(e,"slot","title")},m(s,l){D(s,e,l),p(e,t)},p:T,d(s){s&&d(e)}}}function hl(r){let e,t;return e=new bs({props:{slot:"content",items:r[0]}}),{c(){W(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,l){X(e,s,l),t=!0},p:T,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function ul(r){let e,t,s;return t=new ws({props:{$$slots:{content:[hl],title:[fl],icon:[cl]},$$scope:{ctx:r}}}),{c(){e=m("div"),W(t.$$.fragment),this.h()},l(l){e=v(l,"DIV",{class:!0});var i=g(e);Z(t.$$.fragment,i),i.forEach(d),this.h()},h(){M(e,"class","character svelte-1hztnux")},m(l,i){D(l,e,i),X(t,e,null),s=!0},p(l,[i]){const n={};i&2&&(n.$$scope={dirty:i,ctx:l}),t.$set(n)},i(l){s||(k(t.$$.fragment,l),s=!0)},o(l){S(t.$$.fragment,l),s=!1},d(l){l&&d(e),A(t)}}}function pl(r){return[[{label:"Stats",value:1,component:sl},{label:"Inventory",value:2,component:ol}]]}class dl extends O{constructor(e){super(),Y(this,e,pl,ul,q,{})}}function _l(r){let e,t,s,l;return{c(){e=m("div"),t=m("div"),s=m("p"),l=w("Hacking software by Exploitercorp"),this.h()},l(i){e=v(i,"DIV",{class:!0});var n=g(e);t=v(n,"DIV",{class:!0});var o=g(t);s=v(o,"P",{class:!0});var a=g(s);l=b(a,"Hacking software by Exploitercorp"),a.forEach(d),o.forEach(d),n.forEach(d),this.h()},h(){M(s,"class","svelte-77l1v0"),M(t,"class","copyright svelte-77l1v0"),M(e,"class","exploits")},m(i,n){D(i,e,n),p(e,t),p(t,s),p(s,l)},p:T,i:T,o:T,d(i){i&&d(e)}}}class os extends O{constructor(e){super(),Y(this,e,null,_l,q,{})}}function ml(r){let e,t,s,l,i,n,o;return{c(){e=m("div"),t=m("div"),s=m("span"),l=w("Scanning..."),i=V(),n=m("div"),o=m("div"),this.h()},l(a){e=v(a,"DIV",{class:!0});var c=g(e);t=v(c,"DIV",{class:!0});var h=g(t);s=v(h,"SPAN",{class:!0});var f=g(s);l=b(f,"Scanning..."),f.forEach(d),i=x(h),n=v(h,"DIV",{class:!0});var u=g(n);o=v(u,"DIV",{class:!0}),g(o).forEach(d),u.forEach(d),h.forEach(d),c.forEach(d),this.h()},h(){M(s,"class","svelte-1sv1ca0"),M(o,"class","loading-bar-fill svelte-1sv1ca0"),M(n,"class","loading-bar svelte-1sv1ca0"),M(t,"class","content svelte-1sv1ca0"),M(e,"class","scan-loading svelte-1sv1ca0")},m(a,c){D(a,e,c),p(e,t),p(t,s),p(s,l),p(t,i),p(t,n),p(n,o)},p:T,d(a){a&&d(e)}}}function vl(r){let e;function t(i,n){return i[0]?yl:gl}let s=t(r),l=s(r);return{c(){l.c(),e=R()},l(i){l.l(i),e=R()},m(i,n){l.m(i,n),D(i,e,n)},p(i,n){s===(s=t(i))&&l?l.p(i,n):(l.d(1),l=s(i),l&&(l.c(),l.m(e.parentNode,e)))},d(i){l.d(i),i&&d(e)}}}function gl(r){let e;return{c(){e=w("Scan some entity...")},l(t){e=b(t,"Scan some entity...")},m(t,s){D(t,e,s)},p:T,d(t){t&&d(e)}}}function yl(r){let e;function t(i,n){return i[0].stats.hp>0?wl:$l}let s=t(r),l=s(r);return{c(){l.c(),e=R()},l(i){l.l(i),e=R()},m(i,n){l.m(i,n),D(i,e,n)},p(i,n){s===(s=t(i))&&l?l.p(i,n):(l.d(1),l=s(i),l&&(l.c(),l.m(e.parentNode,e)))},d(i){l.d(i),i&&d(e)}}}function $l(r){let e,t,s,l=r[0].displayName+"",i,n,o,a;return{c(){e=m("div"),t=m("h3"),s=w("Scanned: "),i=w(l),n=V(),o=m("p"),a=w("Entity is dead.")},l(c){e=v(c,"DIV",{});var h=g(e);t=v(h,"H3",{});var f=g(t);s=b(f,"Scanned: "),i=b(f,l),f.forEach(d),n=x(h),o=v(h,"P",{});var u=g(o);a=b(u,"Entity is dead."),u.forEach(d),h.forEach(d)},m(c,h){D(c,e,h),p(e,t),p(t,s),p(t,i),p(e,n),p(e,o),p(o,a)},p(c,h){h&1&&l!==(l=c[0].displayName+"")&&z(i,l)},d(c){c&&d(e)}}}function wl(r){let e,t,s,l=r[0].displayName+"",i,n,o,a,c=r[0].stats.hp+"",h,f,u=r[0].stats.maxHp+"",_,y,$,N,H=r[0].stats.armor+"",P,G,Q,J,C=r[0].stats.evasion+"",U,ee,te,ne,le=r[0].stats.baseDmg+"",ie,re,ae,lt,we=r[0].stats.critChance+"",We,it,oe,nt,be=r[0].stats.critDmg+"",Xe,rt,ce,at,Ee=r[0].stats.accuracy+"",Ae,ot,fe,ct,Me=r[0].stats.fireRate+"",Oe,ft,he,ht,ke=r[0].stats.poisonDmg+"",Ye,ut,ue,pt,De=r[0].stats.electricityDmg+"",qe,dt,pe,_t,Ie=r[0].stats.magneticDmg+"",Le,mt,de,vt,Se=r[0].stats.coldDmg+"",Ze,gt,_e,yt,Ve=r[0].stats.fireDmg+"",Ge,$t,me,wt,xe=r[0].stats.strength+"",Qe,bt,ve,Et,Pe=r[0].stats.agility+"",Fe,Mt,ge,kt,Te=r[0].stats.intelligence+"",Ue,Dt,ye,It,Ne=r[0].stats.fame+"",Be;return{c(){e=m("div"),t=m("h3"),s=w("Scanned: "),i=w(l),n=V(),o=m("p"),a=w("Health: "),h=w(c),f=w("/"),_=w(u),y=V(),$=m("p"),N=w("Armor: "),P=w(H),G=V(),Q=m("p"),J=w("Evasion: "),U=w(C),ee=V(),te=m("p"),ne=w("Damage: "),ie=w(le),re=V(),ae=m("p"),lt=w("critChance: "),We=w(we),it=V(),oe=m("p"),nt=w("critDmg: "),Xe=w(be),rt=V(),ce=m("p"),at=w("accuracy: "),Ae=w(Ee),ot=V(),fe=m("p"),ct=w("fireRate: "),Oe=w(Me),ft=V(),he=m("p"),ht=w("poisonDmg: "),Ye=w(ke),ut=V(),ue=m("p"),pt=w("electricityDmg: "),qe=w(De),dt=V(),pe=m("p"),_t=w("magneticDmg: "),Le=w(Ie),mt=V(),de=m("p"),vt=w("coldDmg: "),Ze=w(Se),gt=V(),_e=m("p"),yt=w("fireDmg: "),Ge=w(Ve),$t=V(),me=m("p"),wt=w("strength: "),Qe=w(xe),bt=V(),ve=m("p"),Et=w("agility: "),Fe=w(Pe),Mt=V(),ge=m("p"),kt=w("intelligence: "),Ue=w(Te),Dt=V(),ye=m("p"),It=w("fame: "),Be=w(Ne),this.h()},l(j){e=v(j,"DIV",{class:!0});var E=g(e);t=v(E,"H3",{});var St=g(t);s=b(St,"Scanned: "),i=b(St,l),St.forEach(d),n=x(E),o=v(E,"P",{});var ze=g(o);a=b(ze,"Health: "),h=b(ze,c),f=b(ze,"/"),_=b(ze,u),ze.forEach(d),y=x(E),$=v(E,"P",{});var Vt=g($);N=b(Vt,"Armor: "),P=b(Vt,H),Vt.forEach(d),G=x(E),Q=v(E,"P",{});var xt=g(Q);J=b(xt,"Evasion: "),U=b(xt,C),xt.forEach(d),ee=x(E),te=v(E,"P",{});var Pt=g(te);ne=b(Pt,"Damage: "),ie=b(Pt,le),Pt.forEach(d),re=x(E),ae=v(E,"P",{});var Tt=g(ae);lt=b(Tt,"critChance: "),We=b(Tt,we),Tt.forEach(d),it=x(E),oe=v(E,"P",{});var Nt=g(oe);nt=b(Nt,"critDmg: "),Xe=b(Nt,be),Nt.forEach(d),rt=x(E),ce=v(E,"P",{});var zt=g(ce);at=b(zt,"accuracy: "),Ae=b(zt,Ee),zt.forEach(d),ot=x(E),fe=v(E,"P",{});var Ht=g(fe);ct=b(Ht,"fireRate: "),Oe=b(Ht,Me),Ht.forEach(d),ft=x(E),he=v(E,"P",{});var Rt=g(he);ht=b(Rt,"poisonDmg: "),Ye=b(Rt,ke),Rt.forEach(d),ut=x(E),ue=v(E,"P",{});var Ct=g(ue);pt=b(Ct,"electricityDmg: "),qe=b(Ct,De),Ct.forEach(d),dt=x(E),pe=v(E,"P",{});var jt=g(pe);_t=b(jt,"magneticDmg: "),Le=b(jt,Ie),jt.forEach(d),mt=x(E),de=v(E,"P",{});var Wt=g(de);vt=b(Wt,"coldDmg: "),Ze=b(Wt,Se),Wt.forEach(d),gt=x(E),_e=v(E,"P",{});var Xt=g(_e);yt=b(Xt,"fireDmg: "),Ge=b(Xt,Ve),Xt.forEach(d),$t=x(E),me=v(E,"P",{});var At=g(me);wt=b(At,"strength: "),Qe=b(At,xe),At.forEach(d),bt=x(E),ve=v(E,"P",{});var Ot=g(ve);Et=b(Ot,"agility: "),Fe=b(Ot,Pe),Ot.forEach(d),Mt=x(E),ge=v(E,"P",{});var Yt=g(ge);kt=b(Yt,"intelligence: "),Ue=b(Yt,Te),Yt.forEach(d),Dt=x(E),ye=v(E,"P",{});var qt=g(ye);It=b(qt,"fame: "),Be=b(qt,Ne),qt.forEach(d),E.forEach(d),this.h()},h(){M(e,"class","entity-scanned")},m(j,E){D(j,e,E),p(e,t),p(t,s),p(t,i),p(e,n),p(e,o),p(o,a),p(o,h),p(o,f),p(o,_),p(e,y),p(e,$),p($,N),p($,P),p(e,G),p(e,Q),p(Q,J),p(Q,U),p(e,ee),p(e,te),p(te,ne),p(te,ie),p(e,re),p(e,ae),p(ae,lt),p(ae,We),p(e,it),p(e,oe),p(oe,nt),p(oe,Xe),p(e,rt),p(e,ce),p(ce,at),p(ce,Ae),p(e,ot),p(e,fe),p(fe,ct),p(fe,Oe),p(e,ft),p(e,he),p(he,ht),p(he,Ye),p(e,ut),p(e,ue),p(ue,pt),p(ue,qe),p(e,dt),p(e,pe),p(pe,_t),p(pe,Le),p(e,mt),p(e,de),p(de,vt),p(de,Ze),p(e,gt),p(e,_e),p(_e,yt),p(_e,Ge),p(e,$t),p(e,me),p(me,wt),p(me,Qe),p(e,bt),p(e,ve),p(ve,Et),p(ve,Fe),p(e,Mt),p(e,ge),p(ge,kt),p(ge,Ue),p(e,Dt),p(e,ye),p(ye,It),p(ye,Be)},p(j,E){E&1&&l!==(l=j[0].displayName+"")&&z(i,l),E&1&&c!==(c=j[0].stats.hp+"")&&z(h,c),E&1&&u!==(u=j[0].stats.maxHp+"")&&z(_,u),E&1&&H!==(H=j[0].stats.armor+"")&&z(P,H),E&1&&C!==(C=j[0].stats.evasion+"")&&z(U,C),E&1&&le!==(le=j[0].stats.baseDmg+"")&&z(ie,le),E&1&&we!==(we=j[0].stats.critChance+"")&&z(We,we),E&1&&be!==(be=j[0].stats.critDmg+"")&&z(Xe,be),E&1&&Ee!==(Ee=j[0].stats.accuracy+"")&&z(Ae,Ee),E&1&&Me!==(Me=j[0].stats.fireRate+"")&&z(Oe,Me),E&1&&ke!==(ke=j[0].stats.poisonDmg+"")&&z(Ye,ke),E&1&&De!==(De=j[0].stats.electricityDmg+"")&&z(qe,De),E&1&&Ie!==(Ie=j[0].stats.magneticDmg+"")&&z(Le,Ie),E&1&&Se!==(Se=j[0].stats.coldDmg+"")&&z(Ze,Se),E&1&&Ve!==(Ve=j[0].stats.fireDmg+"")&&z(Ge,Ve),E&1&&xe!==(xe=j[0].stats.strength+"")&&z(Qe,xe),E&1&&Pe!==(Pe=j[0].stats.agility+"")&&z(Fe,Pe),E&1&&Te!==(Te=j[0].stats.intelligence+"")&&z(Ue,Te),E&1&&Ne!==(Ne=j[0].stats.fame+"")&&z(Be,Ne)},d(j){j&&d(e)}}}function bl(r){let e;function t(i,n){return i[1]?vl:ml}let s=t(r),l=s(r);return{c(){l.c(),e=R()},l(i){l.l(i),e=R()},m(i,n){l.m(i,n),D(i,e,n)},p(i,[n]){s===(s=t(i))&&l?l.p(i,n):(l.d(1),l=s(i),l&&(l.c(),l.m(e.parentNode,e)))},i:T,o:T,d(i){l.d(i),i&&d(e)}}}function El(r,e,t){let s;L(r,et,a=>t(0,s=a));let l=!0,i=null;function n(a){i!=(a==null?void 0:a.id)&&(t(1,l=!1),i=a.id,setTimeout(o,1300))}function o(){t(1,l=!0)}return r.$$.update=()=>{r.$$.dirty&1&&n(s)},[s,l]}class Ml extends O{constructor(e){super(),Y(this,e,El,bl,q,{})}}function kl(r){let e;return{c(){e=m("div"),this.h()},l(t){e=v(t,"DIV",{slot:!0,class:!0}),g(e).forEach(d),this.h()},h(){M(e,"slot","icon"),M(e,"class","icon svelte-1jxg3eh")},m(t,s){D(t,e,s)},p:T,d(t){t&&d(e)}}}function Dl(r){let e,t;return{c(){e=m("div"),t=w("Cyberdeck"),this.h()},l(s){e=v(s,"DIV",{slot:!0});var l=g(e);t=b(l,"Cyberdeck"),l.forEach(d),this.h()},h(){M(e,"slot","title")},m(s,l){D(s,e,l),p(e,t)},p:T,d(s){s&&d(e)}}}function Il(r){let e,t;return e=new bs({props:{slot:"content",items:r[0]}}),{c(){W(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,l){X(e,s,l),t=!0},p:T,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function Sl(r){let e,t,s;return t=new ws({props:{$$slots:{content:[Il],title:[Dl],icon:[kl]},$$scope:{ctx:r}}}),{c(){e=m("div"),W(t.$$.fragment),this.h()},l(l){e=v(l,"DIV",{class:!0});var i=g(e);Z(t.$$.fragment,i),i.forEach(d),this.h()},h(){M(e,"class","cyberdeck svelte-1jxg3eh")},m(l,i){D(l,e,i),X(t,e,null),s=!0},p(l,[i]){const n={};i&2&&(n.$$scope={dirty:i,ctx:l}),t.$set(n)},i(l){s||(k(t.$$.fragment,l),s=!0)},o(l){S(t.$$.fragment,l),s=!1},d(l){l&&d(e),A(t)}}}function Vl(r){return[[{label:"Scanner",value:1,component:Ml},{label:"Exploit",value:2,component:os},{label:"Firewall",value:3,component:os}]]}class xl extends O{constructor(e){super(),Y(this,e,Vl,Sl,q,{})}}const Ce=Re(72),je=Re(10);function Pl(r){let e,t,s,l;return{c(){e=m("div"),this.h()},l(i){e=v(i,"DIV",{class:!0}),g(e).forEach(d),this.h()},h(){M(e,"class",t="entity entity-"+r[0].name+" "+(r[2]==r[0]?"target":null)+" svelte-4yftm2"),I(e,"top",`${r[0].y*r[3]}px`),I(e,"left",`${r[0].x*r[3]}px`),I(e,"width",`${r[3]}px`),I(e,"height",`${r[3]}px`),I(e,"opacity",2-r[1])},m(i,n){D(i,e,n),s||(l=He(e,"click",r[4]),s=!0)},p(i,[n]){n&5&&t!==(t="entity entity-"+i[0].name+" "+(i[2]==i[0]?"target":null)+" svelte-4yftm2")&&M(e,"class",t),n&9&&I(e,"top",`${i[0].y*i[3]}px`),n&9&&I(e,"left",`${i[0].x*i[3]}px`),n&8&&I(e,"width",`${i[3]}px`),n&8&&I(e,"height",`${i[3]}px`),n&2&&I(e,"opacity",2-i[1])},i:T,o:T,d(i){i&&d(e),s=!1,l()}}}function Tl(r,e,t){let s,l,i,n,o,a;L(r,je,f=>t(6,i=f)),L(r,se,f=>t(7,n=f)),L(r,et,f=>t(2,o=f)),L(r,Ce,f=>t(3,a=f));let{entity:c}=e;function h(){et.set(c)}return r.$$set=f=>{"entity"in f&&t(0,c=f.entity)},r.$$.update=()=>{r.$$.dirty&128&&t(5,s=n.player),r.$$.dirty&97&&t(1,l=Math.sqrt((s.x-c.x)*(s.x-c.x)+(s.y-c.y)*(s.y-c.y))/i*2)},[c,l,o,a,h,s,i,n]}class Nl extends O{constructor(e){super(),Y(this,e,Tl,Pl,q,{entity:0})}}function cs(r,e,t){const s=r.slice();return s[3]=e[t],s}function fs(r){let e,t;return e=new Nl({props:{entity:r[3]}}),{c(){W(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,l){X(e,s,l),t=!0},p(s,l){const i={};l&1&&(i.entity=s[3]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function hs(r,e){let t,s=e[1](e[3]),l,i,n=s&&fs(e);return{key:r,first:null,c(){t=R(),n&&n.c(),l=R(),this.h()},l(o){t=R(),n&&n.l(o),l=R(),this.h()},h(){this.first=t},m(o,a){D(o,t,a),n&&n.m(o,a),D(o,l,a),i=!0},p(o,a){e=o,a&1&&(s=e[1](e[3])),s?n?(n.p(e,a),a&1&&k(n,1)):(n=fs(e),n.c(),k(n,1),n.m(l.parentNode,l)):n&&(B(),S(n,1,1,()=>{n=null}),K())},i(o){i||(k(n),i=!0)},o(o){S(n),i=!1},d(o){o&&d(t),n&&n.d(o),o&&d(l)}}}function zl(r){let e=[],t=new Map,s,l,i=r[0].map.entities;const n=o=>o[3].id;for(let o=0;o<i.length;o+=1){let a=cs(r,i,o),c=n(a);t.set(c,e[o]=hs(c,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();s=R()},l(o){for(let a=0;a<e.length;a+=1)e[a].l(o);s=R()},m(o,a){for(let c=0;c<e.length;c+=1)e[c].m(o,a);D(o,s,a),l=!0},p(o,[a]){a&3&&(i=o[0].map.entities,B(),e=tt(e,a,n,1,o,i,t,s.parentNode,st,hs,s,cs),K())},i(o){if(!l){for(let a=0;a<i.length;a+=1)k(e[a]);l=!0}},o(o){for(let a=0;a<e.length;a+=1)S(e[a]);l=!1},d(o){for(let a=0;a<e.length;a+=1)e[a].d(o);o&&d(s)}}}function Hl(r,e,t){let s,l;L(r,je,n=>t(2,s=n)),L(r,se,n=>t(0,l=n));function i(n){let o=Math.abs(l.player.x-n.x),a=Math.abs(l.player.y-n.y);return o<s&&a<s}return[l,i]}class Rl extends O{constructor(e){super(),Y(this,e,Hl,zl,q,{})}}function Cl(r){let e,t=r[0].data+"",s,l;return{c(){e=m("div"),s=w(t),this.h()},l(i){e=v(i,"DIV",{class:!0});var n=g(e);s=b(n,t),n.forEach(d),this.h()},h(){M(e,"class",l="effect effect-"+r[0].type+" svelte-1dvn9ho"),I(e,"top",`${r[0].y*r[1]+Math.random()*40}px`),I(e,"left",`${r[0].x*r[1]+Math.random()*40}px`)},m(i,n){D(i,e,n),p(e,s)},p(i,[n]){n&1&&t!==(t=i[0].data+"")&&z(s,t),n&1&&l!==(l="effect effect-"+i[0].type+" svelte-1dvn9ho")&&M(e,"class",l),n&3&&I(e,"top",`${i[0].y*i[1]+Math.random()*40}px`),n&3&&I(e,"left",`${i[0].x*i[1]+Math.random()*40}px`)},i:T,o:T,d(i){i&&d(e)}}}function jl(r,e,t){let s;L(r,Ce,i=>t(1,s=i));let{effect:l}=e;return r.$$set=i=>{"effect"in i&&t(0,l=i.effect)},[l,s]}class Wl extends O{constructor(e){super(),Y(this,e,jl,Cl,q,{effect:0})}}function us(r,e,t){const s=r.slice();return s[3]=e[t],s}function ps(r){let e,t;return e=new Wl({props:{effect:r[3]}}),{c(){W(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,l){X(e,s,l),t=!0},p(s,l){const i={};l&1&&(i.effect=s[3]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function ds(r,e){let t,s=e[1](e[3]),l,i,n=s&&ps(e);return{key:r,first:null,c(){t=R(),n&&n.c(),l=R(),this.h()},l(o){t=R(),n&&n.l(o),l=R(),this.h()},h(){this.first=t},m(o,a){D(o,t,a),n&&n.m(o,a),D(o,l,a),i=!0},p(o,a){e=o,a&1&&(s=e[1](e[3])),s?n?(n.p(e,a),a&1&&k(n,1)):(n=ps(e),n.c(),k(n,1),n.m(l.parentNode,l)):n&&(B(),S(n,1,1,()=>{n=null}),K())},i(o){i||(k(n),i=!0)},o(o){S(n),i=!1},d(o){o&&d(t),n&&n.d(o),o&&d(l)}}}function Xl(r){let e=[],t=new Map,s,l,i=r[0].effectManager.effectQueue;const n=o=>o[3].id;for(let o=0;o<i.length;o+=1){let a=us(r,i,o),c=n(a);t.set(c,e[o]=ds(c,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();s=R()},l(o){for(let a=0;a<e.length;a+=1)e[a].l(o);s=R()},m(o,a){for(let c=0;c<e.length;c+=1)e[c].m(o,a);D(o,s,a),l=!0},p(o,[a]){a&3&&(i=o[0].effectManager.effectQueue,B(),e=tt(e,a,n,1,o,i,t,s.parentNode,st,ds,s,us),K())},i(o){if(!l){for(let a=0;a<i.length;a+=1)k(e[a]);l=!0}},o(o){for(let a=0;a<e.length;a+=1)S(e[a]);l=!1},d(o){for(let a=0;a<e.length;a+=1)e[a].d(o);o&&d(s)}}}function Al(r,e,t){let s,l;L(r,je,n=>t(2,s=n)),L(r,se,n=>t(0,l=n));function i(n){let o=Math.abs(l.player.x-n.x),a=Math.abs(l.player.y-n.y);return o<s&&a<s}return[l,i]}class Ol extends O{constructor(e){super(),Y(this,e,Al,Xl,q,{})}}function Yl(r){let e;return{c(){e=m("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),g(e).forEach(d),this.h()},h(){M(e,"class","player svelte-fmisp9"),I(e,"top",`${r[2]}px`),I(e,"left",`${r[1]}px`),I(e,"width",`${r[0]}px`),I(e,"height",`${r[0]}px`)},m(t,s){D(t,e,s)},p(t,[s]){s&4&&I(e,"top",`${t[2]}px`),s&2&&I(e,"left",`${t[1]}px`),s&1&&I(e,"width",`${t[0]}px`),s&1&&I(e,"height",`${t[0]}px`)},i:T,o:T,d(t){t&&d(e)}}}function ql(r,e,t){let s,l,i,n;return L(r,Ce,o=>t(0,i=o)),L(r,se,o=>t(3,n=o)),r.$$.update=()=>{r.$$.dirty&9&&t(2,s=n.player.y*i),r.$$.dirty&9&&t(1,l=n.player.x*i)},[i,l,s,n]}class Ll extends O{constructor(e){super(),Y(this,e,ql,Yl,q,{})}}function Zl(r,e){let t=!1;return(...s)=>{t||(r(...s),t=!0,setTimeout(()=>{t=!1},e))}}function Gl(r){let e,t;return{c:T,l:T,m(s,l){e||(t=[He(window,"keydown",r[0]),He(window,"keyup",r[1])],e=!0)},p:T,i:T,o:T,d(s){e=!1,$s(t)}}}function Ql(r){let e="right",t=[0,0,0,0];function s(){return t[0]||t[1]||t[2]||t[3]}function l(c,h){e=h,s()||a(),t[c]=1}function i(c){switch(c.keyCode){case 38:case 87:l(0,"up");break;case 40:case 83:l(2,"down");break;case 37:case 65:l(3,"left");break;case 39:case 68:l(1,"right");break}}function n(c){switch(c.keyCode){case 38:case 87:t[0]=0,o();break;case 40:case 83:t[2]=0,o();break;case 37:case 65:t[3]=0,o();break;case 39:case 68:t[1]=0,o();break}}function o(){t[0]==1&&(e="up"),t[1]==1&&(e="right"),t[2]==1&&(e="down"),t[3]==1&&(e="left")}const a=Zl(()=>{se.playerAction("move",e),setTimeout(()=>{s()&&a()},150)},130);return[i,n]}class Fl extends O{constructor(e){super(),Y(this,e,Ql,Gl,q,{})}}function Ul(r){let e,t;return{c(){e=m("div"),this.h()},l(s){e=v(s,"DIV",{class:!0}),g(e).forEach(d),this.h()},h(){M(e,"class",t="tile type-"+r[0].type+" svelte-1s0urqv"),I(e,"width",`${Math.floor(r[2])}px`),I(e,"height",`${Math.floor(r[2])}px`),I(e,"left",`${Math.floor(r[0].x*r[2])}px`),I(e,"top",`${Math.floor(r[0].y*r[2])}px`),I(e,"opacity",4-r[1])},m(s,l){D(s,e,l)},p(s,[l]){l&1&&t!==(t="tile type-"+s[0].type+" svelte-1s0urqv")&&M(e,"class",t),l&4&&I(e,"width",`${Math.floor(s[2])}px`),l&4&&I(e,"height",`${Math.floor(s[2])}px`),l&5&&I(e,"left",`${Math.floor(s[0].x*s[2])}px`),l&5&&I(e,"top",`${Math.floor(s[0].y*s[2])}px`),l&2&&I(e,"opacity",4-s[1])},i:T,o:T,d(s){s&&d(e)}}}function Bl(r,e,t){let s,l,i,n,o;L(r,je,c=>t(4,i=c)),L(r,se,c=>t(5,n=c)),L(r,Ce,c=>t(2,o=c));let{tile:a}=e;return r.$$set=c=>{"tile"in c&&t(0,a=c.tile)},r.$$.update=()=>{r.$$.dirty&32&&t(3,s=n.player),r.$$.dirty&25&&t(1,l=Math.sqrt((s.x-a.x)*(s.x-a.x)+(s.y-a.y)*(s.y-a.y))/i*4)},[a,l,o,s,i,n]}class Kl extends O{constructor(e){super(),Y(this,e,Bl,Ul,q,{tile:0})}}const{Map:Ms}=Is;function _s(r,e,t){const s=r.slice();return s[1]=e[t],s}function ms(r,e,t){const s=r.slice();return s[4]=e[t],s}function vs(r){let e,t;return e=new Kl({props:{tile:r[4]}}),{c(){W(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,l){X(e,s,l),t=!0},p(s,l){const i={};l&1&&(i.tile=s[4]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function gs(r,e){let t,s,l,i=e[4].type!=0&&vs(e);return{key:r,first:null,c(){t=R(),i&&i.c(),s=R(),this.h()},l(n){t=R(),i&&i.l(n),s=R(),this.h()},h(){this.first=t},m(n,o){D(n,t,o),i&&i.m(n,o),D(n,s,o),l=!0},p(n,o){e=n,e[4].type!=0?i?(i.p(e,o),o&1&&k(i,1)):(i=vs(e),i.c(),k(i,1),i.m(s.parentNode,s)):i&&(B(),S(i,1,1,()=>{i=null}),K())},i(n){l||(k(i),l=!0)},o(n){S(i),l=!1},d(n){n&&d(t),i&&i.d(n),n&&d(s)}}}function ys(r,e){let t,s=[],l=new Ms,i,n,o=e[1];const a=c=>c[4].id;for(let c=0;c<o.length;c+=1){let h=ms(e,o,c),f=a(h);l.set(f,s[c]=gs(f,h))}return{key:r,first:null,c(){t=R();for(let c=0;c<s.length;c+=1)s[c].c();i=R(),this.h()},l(c){t=R();for(let h=0;h<s.length;h+=1)s[h].l(c);i=R(),this.h()},h(){this.first=t},m(c,h){D(c,t,h);for(let f=0;f<s.length;f+=1)s[f].m(c,h);D(c,i,h),n=!0},p(c,h){e=c,h&1&&(o=e[1],B(),s=tt(s,h,a,1,e,o,l,i.parentNode,st,gs,i,ms),K())},i(c){if(!n){for(let h=0;h<o.length;h+=1)k(s[h]);n=!0}},o(c){for(let h=0;h<s.length;h+=1)S(s[h]);n=!1},d(c){c&&d(t);for(let h=0;h<s.length;h+=1)s[h].d(c);c&&d(i)}}}function Jl(r){let e,t=[],s=new Ms,l,i=r[0];const n=o=>o[1].id;for(let o=0;o<i.length;o+=1){let a=_s(r,i,o),c=n(a);s.set(c,t[o]=ys(c,a))}return{c(){e=m("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=v(o,"DIV",{class:!0});var a=g(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(d),this.h()},h(){M(e,"class","map svelte-pklk0d")},m(o,a){D(o,e,a);for(let c=0;c<t.length;c+=1)t[c].m(e,null);l=!0},p(o,[a]){a&1&&(i=o[0],B(),t=tt(t,a,n,1,o,i,s,e,st,ys,null,_s),K())},i(o){if(!l){for(let a=0;a<i.length;a+=1)k(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)S(t[a]);l=!1},d(o){o&&d(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ei(r,e,t){let{visibleTerrain:s}=e;return r.$$set=l=>{"visibleTerrain"in l&&t(0,s=l.visibleTerrain)},[s]}let ti=class extends O{constructor(e){super(),Y(this,e,ei,Jl,q,{visibleTerrain:0})}};function si(r){let e,t,s,l,i,n,o,a,c,h,f,u,_;return e=new Fl({}),i=new Ll({}),o=new Rl({}),c=new Ol({}),f=new ti({props:{visibleTerrain:r[4]}}),{c(){W(e.$$.fragment),t=V(),s=m("div"),l=m("div"),W(i.$$.fragment),n=V(),W(o.$$.fragment),a=V(),W(c.$$.fragment),h=V(),W(f.$$.fragment),this.h()},l(y){Z(e.$$.fragment,y),t=x(y),s=v(y,"DIV",{class:!0});var $=g(s);l=v($,"DIV",{class:!0});var N=g(l);Z(i.$$.fragment,N),n=x(N),Z(o.$$.fragment,N),a=x(N),Z(c.$$.fragment,N),h=x(N),Z(f.$$.fragment,N),N.forEach(d),$.forEach(d),this.h()},h(){M(l,"class","world svelte-129gii6"),I(l,"top",`${r[2]}px`),I(l,"left",`${r[3]}px`),M(s,"class","viewport svelte-129gii6"),Ss(()=>r[8].call(s))},m(y,$){X(e,y,$),D(y,t,$),D(y,s,$),p(s,l),X(i,l,null),p(l,n),X(o,l,null),p(l,a),X(c,l,null),p(l,h),X(f,l,null),u=Vs(s,r[8].bind(s)),_=!0},p(y,[$]){const N={};$&16&&(N.visibleTerrain=y[4]),f.$set(N),$&4&&I(l,"top",`${y[2]}px`),$&8&&I(l,"left",`${y[3]}px`)},i(y){_||(k(e.$$.fragment,y),k(i.$$.fragment,y),k(o.$$.fragment,y),k(c.$$.fragment,y),k(f.$$.fragment,y),_=!0)},o(y){S(e.$$.fragment,y),S(i.$$.fragment,y),S(o.$$.fragment,y),S(c.$$.fragment,y),S(f.$$.fragment,y),_=!1},d(y){A(e,y),y&&d(t),y&&d(s),A(i),A(o),A(c),A(f),u()}}}function li(r,e,t){let s,l,i,n,o,a;L(r,Ce,u=>t(5,n=u)),L(r,se,u=>t(6,o=u)),L(r,je,u=>t(7,a=u));let c,h;function f(){c=this.clientWidth,h=this.clientHeight,t(0,c),t(1,h)}return r.$$.update=()=>{r.$$.dirty&192&&t(4,s=o.map.getTerrainRectangle(o.player.x,o.player.y,a,a)),r.$$.dirty&97&&t(3,l=-o.player.x*n+c/2),r.$$.dirty&98&&t(2,i=-o.player.y*n+h/2)},[c,h,i,l,s,n,o,a,f]}class ii extends O{constructor(e){super(),Y(this,e,li,si,q,{})}}function ni(r){let e,t,s,l,i,n=r[1].stage+"",o,a;return t=new ii({}),{c(){e=m("div"),W(t.$$.fragment),s=V(),l=m("div"),i=w("Stage "),o=w(n),this.h()},l(c){e=v(c,"DIV",{class:!0});var h=g(e);Z(t.$$.fragment,h),s=x(h),l=v(h,"DIV",{class:!0});var f=g(l);i=b(f,"Stage "),o=b(f,n),f.forEach(d),h.forEach(d),this.h()},h(){M(l,"class","status-bar svelte-cmwhqq"),M(e,"class","gameplay svelte-cmwhqq"),I(e,"opacity",r[0])},m(c,h){D(c,e,h),X(t,e,null),p(e,s),p(e,l),p(l,i),p(l,o),a=!0},p(c,[h]){(!a||h&2)&&n!==(n=c[1].stage+"")&&z(o,n),h&1&&I(e,"opacity",c[0])},i(c){a||(k(t.$$.fragment,c),a=!0)},o(c){S(t.$$.fragment,c),a=!1},d(c){c&&d(e),A(t)}}}function ri(r,e,t){let s;L(r,se,i=>t(1,s=i));let l=0;return setTimeout(()=>{t(0,l=1)},100),[l,s]}class ai extends O{constructor(e){super(),Y(this,e,ri,ni,q,{})}}function oi(r){let e;return{c(){e=w(`This is a raid. You have just entered corporate building with a goal of stealing their resources.
The building is protected by guards so be careful! Try reaching next stage by finding an elevator.`)},l(t){e=b(t,`This is a raid. You have just entered corporate building with a goal of stealing their resources.
The building is protected by guards so be careful! Try reaching next stage by finding an elevator.`)},m(t,s){D(t,e,s)},p:T,i:T,o:T,d(t){t&&d(e)}}}class ci extends O{constructor(e){super(),Y(this,e,null,oi,q,{})}}function fi(r){let e,t,s,l,i,n,o,a,c,h;return t=new Rs({}),l=new ai({}),o=new xl({}),c=new dl({}),{c(){e=m("div"),W(t.$$.fragment),s=V(),W(l.$$.fragment),i=V(),n=m("div"),W(o.$$.fragment),a=V(),W(c.$$.fragment),this.h()},l(f){e=v(f,"DIV",{class:!0});var u=g(e);Z(t.$$.fragment,u),s=x(u),Z(l.$$.fragment,u),i=x(u),n=v(u,"DIV",{class:!0});var _=g(n);Z(o.$$.fragment,_),a=x(_),Z(c.$$.fragment,_),_.forEach(d),u.forEach(d),this.h()},h(){M(n,"class","sidebar svelte-pq4q2y"),M(e,"class","game svelte-pq4q2y")},m(f,u){D(f,e,u),X(t,e,null),p(e,s),X(l,e,null),p(e,i),p(e,n),X(o,n,null),p(n,a),X(c,n,null),h=!0},p:T,i(f){h||(k(t.$$.fragment,f),k(l.$$.fragment,f),k(o.$$.fragment,f),k(c.$$.fragment,f),h=!0)},o(f){S(t.$$.fragment,f),S(l.$$.fragment,f),S(o.$$.fragment,f),S(c.$$.fragment,f),h=!1},d(f){f&&d(e),A(t),A(l),A(o),A(c)}}}function hi(r){return Ft.openWindow({title:"Welcome",component:ci}),[]}class wi extends O{constructor(e){super(),Y(this,e,hi,fi,q,{})}}export{wi as default};
